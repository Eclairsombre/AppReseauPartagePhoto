<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<th:block th:fragment="header-styles">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/common.css}">
</th:block>

<th:block th:fragment="photos-styles">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" th:href="@{/css/photos.css}">
</th:block>

<th:block th:fragment="albums-styles">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" th:href="@{/css/albums.css}">
</th:block>

<th:block th:fragment="auth-styles">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" th:href="@{/css/auth.css}">
</th:block>

<th:block th:fragment="bootstrap-scripts">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</th:block>

<th:block th:fragment="header">
<nav class="navbar">
    <a th:href="@{/}" class="brand">FotoShare</a>

    <button class="nav-toggle" aria-label="Toggle navigation">
        <span class="hamburger"></span>
    </button>

    <div class="nav-links">
        <a th:href="@{/photos}">Photos</a>
        <a th:href="@{/albums}" sec:authorize="isAuthenticated()">Albums</a>
        <a th:href="@{/photos/my}" sec:authorize="isAuthenticated()">Mes photos</a>
        <a th:href="@{/photos/upload}" sec:authorize="isAuthenticated()">Upload</a>

        <span class="nav-separator" sec:authorize="isAuthenticated()">|</span>

        <span sec:authorize="isAuthenticated()" class="user-info">
            <span th:text="${#authentication.name}"></span>
        </span>
        <form th:action="@{/logout}" method="post" class="logout-form" sec:authorize="isAuthenticated()">
            <button type="submit" class="logout-btn">DÃ©connexion</button>
        </form>

        <span class="auth-links" sec:authorize="!isAuthenticated()">
            <a th:href="@{/login}">Connexion</a>
            <a th:href="@{/register}" class="btn-register">Inscription</a>
        </span>
    </div>
</nav>
<script>
(function() {
    const navToggle = document.querySelector('.nav-toggle');
    const navLinks = document.querySelector('.nav-links');

    if (navToggle && navLinks) {
        navToggle.addEventListener('click', function(e) {
            e.stopPropagation();
            navLinks.classList.toggle('active');
            navToggle.classList.toggle('active');
        });

        document.addEventListener('click', function(event) {
            if (!navLinks.contains(event.target) && !navToggle.contains(event.target)) {
                navLinks.classList.remove('active');
                navToggle.classList.remove('active');
            }
        });
    }
})();
</script>
</th:block>

<th:block th:fragment="header-simple">
<nav class="navbar">
    <a th:href="@{/}" class="brand">FotoShare</a>

    <!-- Bouton hamburger pour mobile -->
    <button class="nav-toggle" aria-label="Toggle navigation">
        <span class="hamburger"></span>
    </button>

    <div class="nav-links">
        <a th:href="@{/}">Accueil</a>
        <a th:href="@{/photos}">Photos</a>
        <span class="nav-separator">|</span>
        <span class="auth-links">
            <a th:href="@{/login}">Connexion</a>
            <a th:href="@{/register}" class="btn-register">Inscription</a>
        </span>
    </div>
</nav>
<script>
(function() {
    const navToggle = document.querySelector('.nav-toggle');
    const navLinks = document.querySelector('.nav-links');

    if (navToggle && navLinks) {
        navToggle.addEventListener('click', function(e) {
            e.stopPropagation();
            navLinks.classList.toggle('active');
            navToggle.classList.toggle('active');
        });

        document.addEventListener('click', function(event) {
            if (!navLinks.contains(event.target) && !navToggle.contains(event.target)) {
                navLinks.classList.remove('active');
                navToggle.classList.remove('active');
            }
        });
    }
})();
</script>
</th:block>

</html>

